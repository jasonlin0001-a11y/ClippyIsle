{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/ClippyIsle/ClippyIsle/web/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, FirebaseApp } from 'firebase/app';\nimport { getAuth, Auth } from 'firebase/auth';\nimport { getFirestore, Firestore } from 'firebase/firestore';\nimport { getStorage, FirebaseStorage } from 'firebase/storage';\n\n// Firebase configuration using environment variables\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\n// Check if we're in a browser or server environment with valid config\nconst isConfigValid = firebaseConfig.apiKey && firebaseConfig.projectId;\n\n// Initialize Firebase (avoid double initialization during hot reloads)\nlet app: FirebaseApp | undefined;\nlet auth: Auth | undefined;\nlet db: Firestore | undefined;\nlet storage: FirebaseStorage | undefined;\n\nif (isConfigValid) {\n  if (getApps().length === 0) {\n    app = initializeApp(firebaseConfig);\n  } else {\n    app = getApps()[0];\n  }\n\n  auth = getAuth(app);\n  db = getFirestore(app);\n  storage = getStorage(app);\n}\n\nexport { app, auth, db, storage };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,qDAAqD;AACrD,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,sEAAsE;AACtE,MAAM,gBAAgB,eAAe,MAAM,IAAI,eAAe,SAAS;AAEvE,uEAAuE;AACvE,IAAI;AACJ,IAAI;AACJ,IAAI;AACJ,IAAI;AAEJ,IAAI,eAAe;IACjB,IAAI,IAAA,2KAAO,IAAG,MAAM,KAAK,GAAG;QAC1B,MAAM,IAAA,iLAAa,EAAC;IACtB,OAAO;QACL,MAAM,IAAA,2KAAO,GAAE,CAAC,EAAE;IACpB;IAEA,OAAO,IAAA,6KAAO,EAAC;IACf,KAAK,IAAA,iLAAY,EAAC;IAClB,UAAU,IAAA,kMAAU,EAAC;AACvB"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/ClippyIsle/ClippyIsle/web/src/context/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useEffect, useState, ReactNode, useMemo } from 'react';\nimport { User, onAuthStateChanged, signOut as firebaseSignOut } from 'firebase/auth';\nimport { doc, getDoc } from 'firebase/firestore';\nimport { auth, db } from '@/lib/firebase';\n\ninterface AuthContextType {\n  user: User | null;\n  isAdmin: boolean;\n  loading: boolean;\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  isAdmin: false,\n  loading: true,\n  signOut: async () => {},\n});\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isAdmin, setIsAdmin] = useState(false);\n  // If Firebase is not initialized, we're not loading\n  const [loading, setLoading] = useState(!!auth);\n\n  useEffect(() => {\n    // If Firebase is not initialized, don't set up the listener\n    if (!auth) {\n      return;\n    }\n\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      setLoading(true);\n      \n      if (firebaseUser) {\n        setUser(firebaseUser);\n        \n        // Check if user is admin by checking admins collection\n        try {\n          if (db) {\n            const adminDocRef = doc(db, 'admins', firebaseUser.uid);\n            const adminDoc = await getDoc(adminDocRef);\n            setIsAdmin(adminDoc.exists());\n          } else {\n            setIsAdmin(false);\n          }\n        } catch (error) {\n          console.error('Error checking admin status:', error);\n          setIsAdmin(false);\n        }\n      } else {\n        setUser(null);\n        setIsAdmin(false);\n      }\n      \n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const signOut = async () => {\n    if (!auth) return;\n    \n    try {\n      await firebaseSignOut(auth);\n      setUser(null);\n      setIsAdmin(false);\n    } catch (error) {\n      console.error('Error signing out:', error);\n      throw error;\n    }\n  };\n\n  const value = useMemo(() => ({ user, isAdmin, loading, signOut }), [user, isAdmin, loading]);\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AACA;AAAA;AACA;AALA;;;;;;AAcA,MAAM,4BAAc,IAAA,sNAAa,EAAkB;IACjD,MAAM;IACN,SAAS;IACT,SAAS;IACT,SAAS,WAAa;AACxB;AAEO,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,oDAAoD;IACpD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC,CAAC,CAAC,8HAAI;IAE7C,IAAA,kNAAS,EAAC;QACR,4DAA4D;QAC5D,IAAI,CAAC,8HAAI,EAAE;YACT;QACF;QAEA,MAAM,cAAc,IAAA,wLAAkB,EAAC,8HAAI,EAAE,OAAO;YAClD,WAAW;YAEX,IAAI,cAAc;gBAChB,QAAQ;gBAER,uDAAuD;gBACvD,IAAI;oBACF,IAAI,4HAAE,EAAE;wBACN,MAAM,cAAc,IAAA,wKAAG,EAAC,4HAAE,EAAE,UAAU,aAAa,GAAG;wBACtD,MAAM,WAAW,MAAM,IAAA,2KAAM,EAAC;wBAC9B,WAAW,SAAS,MAAM;oBAC5B,OAAO;wBACL,WAAW;oBACb;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,gCAAgC;oBAC9C,WAAW;gBACb;YACF,OAAO;gBACL,QAAQ;gBACR,WAAW;YACb;YAEA,WAAW;QACb;QAEA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,MAAM,UAAU;QACd,IAAI,CAAC,8HAAI,EAAE;QAEX,IAAI;YACF,MAAM,IAAA,6KAAe,EAAC,8HAAI;YAC1B,QAAQ;YACR,WAAW;QACb,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM;QACR;IACF;IAEA,MAAM,QAAQ,IAAA,gNAAO,EAAC,IAAM,CAAC;YAAE;YAAM;YAAS;YAAS;QAAQ,CAAC,GAAG;QAAC;QAAM;QAAS;KAAQ;IAE3F,qBACE,8OAAC,YAAY,QAAQ;QAAC,OAAO;kBAC1B;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}}]
}